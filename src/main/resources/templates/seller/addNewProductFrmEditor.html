<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
    <th:block th:include="common/header"></th:block>
    	<!-- 썸머노트 -->
    	<script src="/summernote/summernote-lite.js"></script>
		<script src="/summernote/lang/summernote-ko-KR.js"></script>
		<link rel="stylesheet" href="/summernote/summernote-lite.css">

    <div class="page-content">
        <th:block th:include="seller/sellerHeader"></th:block>
        <th:block th:include="seller/sellerMenu"></th:block>
        
            <div class="content-wrap">
                <div class="content-title">
                	<span>
                	ADD NEW PRODUCT
                	</span>
               	</div>
                <div class="content-main">
                	<form action="/seller/addNewProduct" method="post" enctype="multipart/form-data">
                	<table class="tbl-newProduct">
                		<tr>
                			<th>상품명</th>
                			<td colspan="3">
                				<input type="text" name="productName" placeholder="내용을 입력해주세요">
                			</td>
                		</tr>
                		<tr>
                			<th>판매가</th>
                			<td colspan="3">
                				<input type="text" name="productPrice" placeholder="예) 100000">
                			</td>
                		</tr>
                		<tr>
                			<th>옵션설정</th>
                			<td colspan="3">
                				<input type="text" name="productOption">
                			</td>
                		</tr>
                		<tr>
                			<th>상품 카테고리 선택</th>
                			<td colspan="3">
                				<input type="text" name="productCategory">
                			</td>
                		</tr>
                		<tr>
                			<th>대표 이미지 업로드</th>
                			<td colspan="3">
                				<input type="file" name="productImg" id="productImg" accept=".jpg,.png,.jpeg">
                			</td>
                		</tr>
                			<th>대표 이미지 미리보기</th>
                			<td colspan="3">
                				<div class="productImgView">
                					<img id="productImgView" width="300px">
                				</div>
                			</td>
                		<tr>
                		</tr>
                		<tr>
                			<th>상품 요약 설명</th>
                			<td colspan="3">
                				<input type="text" name="productContent" placeholder="내용을 입력해주세요">
                			</td>
                		</tr>
                		<tr>
                			<th>상품 상세 설명</th>
                			<td colspan="3" style="text-align: left;">
                				<textarea name="productContentDetail" id="productContentDetail"></textarea>
                			</td>
                		</tr>
						<tr class="tr-1">
							<td colspan="4">
								<button type="submit">검수 요청</button>
							</td>
						</tr>                		                		                		                		                		                		
                	</table>
                </div>
            </div>   
        </div>        

    <th:block th:include="common/footer"></th:block>
    <script>
	    $("#productContentDetail").summernote({
			height: 400,
			lang : "ko-KR",
			callbacks : {
				onImageUpload : function(files){
					//에디터 본문에 이미지를 삽입하면 동작하는 함수
					uploadImage(files[0],this); //this는 텍스트에디터 자체를 의미한다.
					//파일은 단 하나니까 배열의 [0].
				} 
			}
		});
	    function uploadImage(file,editor){
	    	const form = new FromData();
	    	form.append("file",file);
	    	$.ajax({
	    		url : "/seller/editor",
	    		type : "post",
	    		data : form,
	    		processData : false,
	    		contentType : false,
	    		success : function(data){
	    			$(editor).summernote("insertImage",data);
	    		}
	    	});
	    }
	    
	    $("[name=productImg]").on("change",function(){
	        if(this.files.length != 0 && this.files[0] !=0){
	            const reader = new FileReader();
	            reader.readAsDataURL(this.files[0]);
	            reader.onload = function(e){
	                $("#productImgView").attr("src",e.target.result);
	            }
	        }else{
	            $("#productImgView").attr("src","");
	        }
	    });
    </script>
</body>
</html>